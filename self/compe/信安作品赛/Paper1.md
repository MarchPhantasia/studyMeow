> Nan 等 - 2018 - Finding Clues for Your Secrets Semantics-Driven, Learning-Based Privacy Discovery in Mobile Apps

论文中主要提出了一种称为**ClueFinder**的方法，目的是解决在移动应用中自动识别敏感数据来源并检测隐私泄露的问题。以下是这项方法的原理、步骤以及它解决的问题的详细解释：

### 方法概述
ClueFinder是一种**基于语义驱动的隐私数据发现方法**，结合了自然语言处理（NLP）和机器学习技术，用于从移动应用程序代码中自动提取和识别可能涉及用户敏感数据的程序元素（如变量、方法等）。这项方法不仅可以发现传统系统API泄露的数据，还能够识别通过服务器传输到应用的数据（如用户的社交媒体资料、账户信息等），这些数据往往难以通过传统方法捕捉。

### ClueFinder的原理与步骤
ClueFinder方法分为四个主要步骤，每个步骤都利用了程序中的语义信息进行敏感数据的识别和追踪：

1. **语义定位（Semantics Locator）**：
   - **目的**：找到程序中可能涉及敏感数据的代码元素。
   - **原理**：分析应用程序的代码，通过预定义的一组关键词（如“password”、“location”、“profile”等）以及这些关键词的前缀、缩写来识别程序中的敏感数据相关元素。关键词来自于隐私政策和现有研究中提到的敏感信息类别（如用户标识、用户属性、地理位置等）。
   - **举例**：方法名`getUserProfile`中包含“profile”这一敏感关键词，ClueFinder会将其标记为可能涉及敏感信息的元素。

2. **语法分析（Semantic Checker）**：
   - **目的**：过滤掉语义上与敏感信息无关的代码元素，减少误报。
   - **原理**：利用自然语言处理（NLP）技术对标记的元素进行进一步分析。通过词性标注（POS tagging）和依赖关系解析（Dependency Parsing），判断关键词在代码中是否真正与敏感操作相关。只有当关键词在语义上作为操作对象或描述主题时，该元素才被认为是敏感的。
   - **举例**：`getStreetViewActivity`这个方法名中虽然有“street”，但它实际上与用户位置无关，因此会被过滤掉；而`getUserAddress`则可能真的涉及到获取用户地址信息。

3. **结构分析（Structure Analyzer）**：
   - **目的**：通过分析程序的结构特征，进一步确认代码中是否存在对敏感数据的实际操作。
   - **原理**：分析与标记元素相关的函数调用语句，通过支持向量机（SVM）分类器，利用方法名、参数类型、返回值类型等特征，判断这些调用是否涉及敏感数据的读取或写入。特别关注数据的读取（如从服务器获取用户资料）和写入（如将用户数据传递给第三方库）。
   - **举例**：如果方法`getUserFbProfile`返回一个包含用户信息的`Json`对象，且调用中涉及用户数据的读取或传输，则会被标记为敏感操作。

4. **数据泄露追踪（Leakage Tracker）**：
   - **目的**：识别和追踪敏感数据在程序中的流动路径，以检测是否有数据泄露到第三方库。
   - **原理**：通过语义增强的数据流分析，追踪标记的数据对象在程序中的传播路径。如果这些数据流入了第三方库的API或方法调用中，则认为存在数据泄露的风险。与传统方法不同，ClueFinder结合语义信息可以更快速地确认哪些数据是敏感的，减少数据流追踪的复杂度。
   - **举例**：当应用程序通过第三方SDK（如广告库或分析库）传输用户的地理位置或社交媒体资料时，ClueFinder会检测到这种数据传输，并标记为潜在的隐私泄露。

### ClueFinder解决的问题
ClueFinder主要解决了移动应用隐私分析中的两个关键挑战：

1. **服务器端数据检测难题**：
   - 传统方法多依赖于系统API（如IMEI、GPS等）来检测设备上的敏感数据泄露，但无法覆盖从服务器端下载的数据（如用户的社交网络资料或账户信息）。这些数据的传输通常通过通用的API（如网络通信）进行，很难通过简单的API监测来识别。
   - ClueFinder通过分析程序代码中的语义信息，可以识别出涉及服务器端敏感数据的程序元素，从而填补了这一空白。

2. **代码混淆情况下的隐私检测**：
   - 许多移动应用会使用代码混淆工具（如ProGuard）来保护其程序逻辑，这使得传统的数据流分析方法难以有效跟踪敏感数据的流动。
   - ClueFinder的语义驱动方法，即使在中等程度的混淆下也能正常工作，因为应用程序中涉及数据的元素（如变量名、方法名）通常保留了一些语义信息，以避免影响程序的正常执行。

### SUMMARY
ClueFinder通过结合语义分析和机器学习的方法，自动从应用程序中发现和定位敏感数据的来源，特别是从服务器端获取的数据。这使得它能够在大规模应用程序中更高效地识别潜在的隐私泄露，尤其是在第三方库和广告SDK对用户数据的过度收集方面，提供了全新的视角和更全面的分析能力。它解决了传统方法在处理服务器端数据和应对代码混淆时的不足，使得移动应用隐私分析能够更深入地揭示信息泄露的全貌。