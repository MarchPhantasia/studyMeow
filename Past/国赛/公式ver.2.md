
# 思路分析

三个问题底层都是规划问题。

对于 Q1，目标仅仅是最大化未来 7 年总利润。但对于 Q3，可以考虑最小化风险，如市场风险、气候风险等。

## Q1

### 决策变量

设 $a_{i,j,k}^{t,s}$ 为在未来第 $t$ 年（$t \in \{0, 1, \ldots, T\}$），类型为 $i$ ($i \in \{1, \ldots, I\}$) 的第 $j$ ($j \in \{1, \ldots, J_{i}\}$) 个地块上，在第 $s$ ($s \in \{1, \ldots, S\}$) 季次种植作物 $k$ ($k \in \{1, 2, \ldots, K\}$) 的面积（单位：亩），其中：

- $T = 7$ 为未来总年数。记 $t=1$ 为 2024 年，以此类推，$t=7$ 为 2030 年。
- $I = 6$ 为地块类型总数（如平旱地、梯田、山坡地等，共 6 种）。
- $J_{i}$：类型为 $i$ 的地块总数。
- $S=2$：一年中的季次数量。记 $s=1,2$ 分别为第一季和第二季。
- $K$：作物总数。

特别地，根据假设，$t=0$ 时，$a_{i,j,k}^{0,s}$ 为 2023 年的已知数据。

考虑到耕种作业和田间管理的便利性，我们对不同耕地类型作以下假设：

- 对于露天耕地，即：平旱地、梯田、山坡地和水浇地，某一季只能种植一种作物。
- 对于人工大棚，即：普通大棚和智慧大棚，可以进行二分，让二分后的子耕地，某一季只能种植一种作物，具体而言：
    - 普通大棚：对第一季进行二分
    - 智慧大棚：对两季都进行二分

因此，可以使用新的布尔变量 $x_{i,j,k}^{t,s} \in \{0,1\}$ 简化。

设 $x_{i,j,k}^{t,s}$ 为在未来第 $t$ 年（$t \in \{0, 1, \ldots, T\}$），类型为 $i$ ($i \in \{1, \ldots, I\}$) 的第 $j$ ($j \in \{1, \ldots, J_{i}\}$) 个地块上，在第 $s$ ($s \in \{1, \ldots, S\}$) 季次是否种植作物 $k$ ($k \in \{1, 2, \ldots, K\}$)。则易知：

$$
a_{i,j,k}^{t,s} = x_{i,j,k}^{t,s} \cdot A_{i,j}
$$

其中：$A_{i,j}$ 是类型 $i$ 的第 $j$ 块地的总面积（亩）。

### 目标函数

目标是最大化 2024-2030 年间（即 $t = 1$ 到 $t = 7$）的总利润。

针对情况 1（滞销部分浪费），目标函数为：

$$
\max \sum_{t=1}^{T} \sum_{i=1}^{I} \sum_{j=1}^{J_i} \sum_{s=1}^{S} \sum_{k=1}^{K} \left( P_k^{t,s} \cdot \min \left( a_{i,j,k}^{t,s} \cdot Y_{i,k}^{t,s}, V_{i,k}^{t,s} \right) - C_{i,k}^{t,s} \cdot a_{i,j,k}^{t,s} \right)
$$

针对情况 2（超出部分按 50% 折扣价出售），目标函数为：

$$
\max \sum_{t=1}^{T} \sum_{i=1}^{I} \sum_{j=1}^{J_i} \sum_{s=1}^{S} \sum_{k=1}^{K} \left( P_{k}^{t,s} \cdot \min \left( a_{i,j,k}^{t,s} \cdot Y_{i,k}^{t,s}, V_{i,k}^{t,s} \right)
+ 0.5 \cdot P_{k}^{t,s} \cdot \max \left( 0, a_{i,j,k}^{t,s} \cdot Y_{i,k}^{t,s}V_{i,k}^{t,s} \right)
- C_{i,k}^{t,s} \cdot a_{i,j,k}^{t,s} \right)
$$

其中：

- $a_{i,j,k}^{t,s}$：类型为 $i$ 的第 $j$ 个地块上，在第 $t$ 年第 $s$ 季次种植作物 $k$ 的面积（亩）。
- $P_k^{t,s}$：作物 $k$ 在第 $t$ 年第 $s$ 季次的销售单价（元/斤）。
- $Y_{i,k}^{t,s}$：作物 $k$ 在第 $t$ 年第 $s$ 季次中，于类型为 $i$ 的地块上种植的亩产量（斤/亩）。
- $V_{i,k}^{t,s}$：作物 $k$ 在第 $t$ 年第 $s$ 季次中，于类型为 $i$ 的地块上的预计销售量（斤）。
- $C_{i,k}^{t,s}$：作物 $k$ 在第 $t$ 年第 $s$ 季次中，于类型为 $i$ 的地块上的种植成本（元/亩）。

特别地，根据假设，2023 年统计的数据中，预计销售量可根据以下公式计算得到：

$$
V_{i,k}^{0, s} = Y_{i,k}^{0, s} \cdot \sum_{j=0}^{J_{i}}  a_{i,j,k}^{0,s}
$$

### 约束条件

#### 总面积约束

每块地在每个季次上的种植面积不能超过其可用面积：

$$
\sum_{k=1}^{K} a_{i,j,k}^{t,s} \leq A_{i,j}, \quad \forall i, \forall j, \forall t, \forall s
$$

其中：$A_{i,j}$ 是类型 $i$ 的第 $j$ 块地的总面积（亩）。

由于我们使用布尔变量 $x_{i,j,k}^{t,s}$ 进行简化，因而该约束一定满足。

#### 作物类型约束

根据地块类型和季次的不同，某些作物只能在特定地块类型和季次上种植：

$$
a_{i,j,k}^{t,s} = 0, \quad \text{若作物} \, k \, \text{不适合种植在类型为} \, i \, \text{的地块或第} \, s \, \text{季次}
$$

#### 轮作约束

为防止连续两年在同一地块上种植相同作物，轮作约束条件为：

$$
a_{i,j,k}^{t,s} \cdot a_{i,j,k}^{t+1,s'} = 0, \quad \forall i, \forall j, \forall k, \forall s, \forall s', \forall t
$$

同一年不同季次同一地块上不能种植相同作物：

$$
a_{i,j,k}^{t,s} \cdot a_{i,j,k}^{t,s'} = 0, \quad \forall i, \forall j, \forall k, \forall s, \forall s', \forall t
$$

此外，从 2023 年开始，要求每块地在三年内至少种植一次豆类作物：

$$
\sum_{t=t_1}^{t_3} \sum_{s=1}^{S} a_{i,j,\text{legume}}^{t,s} \geq 1, \quad \forall i, \forall j
$$
